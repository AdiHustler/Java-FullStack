package com.connectdatabase;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.sql.Statement;

public class FindStudentData {

	public static void main(String[] args) {
		
		String url="jdbc:postgresql://localhost:5432/postgres";
		String un="postgres";
		String pwd="root";
		// Load the driver class
		try {
			Class.forName("org.postgresql.Driver"); // forName() imported from 'lang' package, it is imported by default
			
			// To establish Connection
			Connection connect = DriverManager.getConnection(url, un, pwd);
			
			// Create a statement
			Statement stmt=connect.createStatement();
			
			// INSERTION in the table
			String ins="INSERT INTO STUDENT VALUES(104,'MICHAEL','michael104@gmail.com','male')";
			stmt.executeUpdate(ins);
			System.out.println("Data successfully inserted into the table");
			
			// The SELECT query to be sent
						String sql="SELECT * FROM STUDENT";
						//	Execution of the SELECT statement
						ResultSet res=stmt.executeQuery(sql);
						System.out.println("Printing all the datat in the table");
						while(res.next()) {
							System.out.println(res.getInt(1)+" "+res.getString(2)+" "+res.getString(4));
						}
			
			// UPDATION in the table
			String upd="UPDATE STUDENT SET gender='MALE' WHERE st_name='MICHAEL'";
			stmt.executeUpdate(upd);
			System.out.println("Data updated into the table");
			
			
			// The SELECT query to be sent
			String sql="SELECT * FROM STUDENT";
			//	Execution of the SELECT statement
			ResultSet res=stmt.executeQuery(sql);
			System.out.println("Printing all the datat in the table");
			while(res.next()) {
				System.out.println(res.getInt("id")+" "+res.getString("name")+" "+res.getString("gender"));
			}
			
			// Deletion from the table
			String del="DELETE FROM STUDENT WHERE ID=104";
			stmt.executeUpdate(del);
			System.out.println("Data deleted from the table");
			
			// Close the connection
			res.close();
			stmt.close();
			connect.close();
			
			
		}catch (ClassNotFoundException e) {
			e.printStackTrace();
		} catch (SQLException e) {
			e.printStackTrace();
		}   

	}

}
